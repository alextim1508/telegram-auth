# Telegram Authentication Service

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ Telegram Login Widget –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Spring Boot. –û–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç Telegram, —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HMAC-SHA256. –≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ [–≤–∏—Ç—Ä–∏–Ω–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞](https://github.com/alextim1508/intershop), –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram.

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1.  **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Ngrok:** –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `secrets/ngrok.yml` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.
    ```yaml
    version: "2"
    authtoken: YOUR_NGROK_AUTH_TOKEN # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω Ngrok
    tunnels:
      myapp:
        proto: http
        addr: host.docker.internal:8080 # –ê–¥—Ä–µ—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Spring Boot –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    ```

2.  **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `secrets/telegramtoken.env`.
    ```env
    # –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
    TELEGRAM_BOT_TOKEN=YOUR_TELEGRAM_BOT_TOKEN # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram-–±–æ—Ç–∞

    # –ò–º—è Telegram-–±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤–∏–¥–∂–µ—Ç–∞)
    TELEGRAM_BOT_NAME=YOUR_TELEGRAM_BOT_USERNAME # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, mybot)
    ```

3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∞–∑–æ–≤—ã–π URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** `APP_BASE_URL` –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ñ–∞–π–ª–µ `docker-compose.yml`. –û–±–Ω–æ–≤–∏—Ç–µ —Ä–∞–∑–¥–µ–ª `environment` –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ `app`:
    ```yaml
    environment:
      APP_BASE_URL: https://YOUR_NGROK_SUBDOMAIN.ngrok-free.dev # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π URL Ngrok
    ```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

1.  **–°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞.**
    ```bash
    git clone https://github.com/alextim1508/telegram-auth
    cd telegram-auth # –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
    ```

2.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:** 
    ```bash
    docker-compose -f docker-compose.yml up -d
    ```

3.  **–î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é:** 
    ```
    https://YOUR_NGROK_URL/auth/telegram
    ```
    –≠—Ç–æ—Ç –∞–¥—Ä–µ—Å –æ—Ç–¥–∞–µ—Ç HTML-—Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π Telegram Login Widget, –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`/auth/telegram/token`).

## üîê –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1.  –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–¥–∞–µ—Ç HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É (`telegramAuth.html`), —Å–æ–¥–µ—Ä–∂–∞—â—É—é Telegram Login Widget.
2.  –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –≤–∏–¥–∂–µ—Ç –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –≤ Telegram, Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (ID, –∏–º—è –∏ —Ç.–¥.) –∏ `hash` –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π URL –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ (`/auth/telegram/token`).
3.  Backend Spring Boot –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ.
4.  Backend —É–¥–∞–ª—è–µ—Ç `hash` –∏–∑ –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–∞—Ä—ã –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö –≤ —Å—Ç—Ä–æ–∫—É (`key1=value1\nkey2=value2...`) –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç —Ö–µ—à HMAC-SHA256, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞.
5.  –í—ã—á–∏—Å–ª–µ–Ω–Ω—ã–π —Ö–µ—à —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è —Å `hash`, –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –æ—Ç Telegram.
6.  –ï—Å–ª–∏ —Ö–µ—à–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ñ–∏–∫—Ç–∏–≤–Ω—ã–π —Ç–æ–∫–µ–Ω (–∏–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Å—Ü–µ–Ω–∞—Ä–∏–∏). –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞.
